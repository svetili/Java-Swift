--------------------------------------------------------
--  File created - Sunday-April-21-2019   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Sequence ACTOR_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "SAKILA"."ACTOR_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence FILM_ACTOR_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "SAKILA"."FILM_ACTOR_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence FILM_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "SAKILA"."FILM_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence ID_ACTOR
--------------------------------------------------------

   CREATE SEQUENCE  "SAKILA"."ID_ACTOR"  MINVALUE 1 MAXVALUE 1000 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence ID_FILM
--------------------------------------------------------

   CREATE SEQUENCE  "SAKILA"."ID_FILM"  MINVALUE 1 MAXVALUE 1000 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Table ACTOR
--------------------------------------------------------

  CREATE TABLE "SAKILA"."ACTOR" 
   (	"ID" NUMBER, 
	"NAME" VARCHAR2(50 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table FILM
--------------------------------------------------------

  CREATE TABLE "SAKILA"."FILM" 
   (	"ID" NUMBER, 
	"NAME" VARCHAR2(50 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table FILM_ACTOR
--------------------------------------------------------

  CREATE TABLE "SAKILA"."FILM_ACTOR" 
   (	"FILM_ID" NUMBER, 
	"ACTOR_ID" NUMBER, 
	"ID" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
REM INSERTING into SAKILA.ACTOR
SET DEFINE OFF;
Insert into SAKILA.ACTOR (ID,NAME) values (9,'Hopkins');
Insert into SAKILA.ACTOR (ID,NAME) values (10,'Hemsworth');
Insert into SAKILA.ACTOR (ID,NAME) values (11,'Evans');
Insert into SAKILA.ACTOR (ID,NAME) values (12,'Johanson');
Insert into SAKILA.ACTOR (ID,NAME) values (13,'Larson');
Insert into SAKILA.ACTOR (ID,NAME) values (15,'Hemsorth');
Insert into SAKILA.ACTOR (ID,NAME) values (16,'Downey Jr.');
Insert into SAKILA.ACTOR (ID,NAME) values (17,'Ruffalo');
REM INSERTING into SAKILA.FILM
SET DEFINE OFF;
Insert into SAKILA.FILM (ID,NAME) values (3,'Avengers');
Insert into SAKILA.FILM (ID,NAME) values (1,'Thor');
Insert into SAKILA.FILM (ID,NAME) values (2,'Captain America');
Insert into SAKILA.FILM (ID,NAME) values (4,'Captain Marvel');
Insert into SAKILA.FILM (ID,NAME) values (5,'Thor 2');
REM INSERTING into SAKILA.FILM_ACTOR
SET DEFINE OFF;
Insert into SAKILA.FILM_ACTOR (FILM_ID,ACTOR_ID,ID) values (3,11,3);
Insert into SAKILA.FILM_ACTOR (FILM_ID,ACTOR_ID,ID) values (4,13,4);
Insert into SAKILA.FILM_ACTOR (FILM_ID,ACTOR_ID,ID) values (1,9,1);
Insert into SAKILA.FILM_ACTOR (FILM_ID,ACTOR_ID,ID) values (2,11,2);
Insert into SAKILA.FILM_ACTOR (FILM_ID,ACTOR_ID,ID) values (5,15,5);
Insert into SAKILA.FILM_ACTOR (FILM_ID,ACTOR_ID,ID) values (3,17,6);
--------------------------------------------------------
--  DDL for Index FILM_ACTOR_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "SAKILA"."FILM_ACTOR_PK" ON "SAKILA"."FILM_ACTOR" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index ACTOR_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "SAKILA"."ACTOR_PK" ON "SAKILA"."ACTOR" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index ACTOR_UK1
--------------------------------------------------------

  CREATE UNIQUE INDEX "SAKILA"."ACTOR_UK1" ON "SAKILA"."ACTOR" ("NAME") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index FILM_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "SAKILA"."FILM_PK" ON "SAKILA"."FILM" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index FILM_UK1
--------------------------------------------------------

  CREATE UNIQUE INDEX "SAKILA"."FILM_UK1" ON "SAKILA"."FILM" ("NAME") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Trigger ACTOR_TRG
--------------------------------------------------------

  CREATE OR REPLACE TRIGGER "SAKILA"."ACTOR_TRG" 
BEFORE INSERT ON ACTOR 
FOR EACH ROW 
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID IS NULL THEN
      SELECT ACTOR_SEQ.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;
/
ALTER TRIGGER "SAKILA"."ACTOR_TRG" ENABLE;
--------------------------------------------------------
--  DDL for Trigger FILM_ACTOR_TRG
--------------------------------------------------------

  CREATE OR REPLACE TRIGGER "SAKILA"."FILM_ACTOR_TRG" 
BEFORE INSERT ON FILM_ACTOR 
FOR EACH ROW 
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID IS NULL THEN
      SELECT FILM_ACTOR_SEQ.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;
/
ALTER TRIGGER "SAKILA"."FILM_ACTOR_TRG" ENABLE;
--------------------------------------------------------
--  DDL for Trigger FILM_TRG
--------------------------------------------------------

  CREATE OR REPLACE TRIGGER "SAKILA"."FILM_TRG" 
BEFORE INSERT ON FILM 
FOR EACH ROW 
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID IS NULL THEN
      SELECT FILM_SEQ.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;
/
ALTER TRIGGER "SAKILA"."FILM_TRG" ENABLE;
--------------------------------------------------------
--  DDL for Procedure ADD_ACTOR
--------------------------------------------------------
set define off;

  CREATE OR REPLACE PROCEDURE "SAKILA"."ADD_ACTOR" 
(
  table_name IN VARCHAR2 
, table_id OUT NUMBER 
) AS 
BEGIN
  SELECT id INTO table_id FROM actor WHERE actor.name = table_name;
  EXCEPTION
  WHEN NO_DATA_FOUND THEN
  INSERT INTO actor (name) VALUES (table_name)
    RETURNING id INTO table_id;
END ADD_ACTOR;

/
--------------------------------------------------------
--  DDL for Procedure ADD_ACTOR_TO_FILM
--------------------------------------------------------
set define off;

  CREATE OR REPLACE PROCEDURE "SAKILA"."ADD_ACTOR_TO_FILM" 
(
  actorname IN VARCHAR2 
, filmname IN VARCHAR2 
) AS
BEGIN
    insert into film_actor (actor_id, film_id)
    select a.id, f.id from actor a, film f where a.name = actorname and f.name = filmname;
END;

/
--------------------------------------------------------
--  DDL for Procedure ADD_FILM
--------------------------------------------------------
set define off;

  CREATE OR REPLACE PROCEDURE "SAKILA"."ADD_FILM" 
(
  table_name IN VARCHAR2
, table_id OUT NUMBER 
) AS 
BEGIN
  SELECT id into table_id from film where film.name = table_name;
  EXCEPTION
  WHEN NO_DATA_FOUND THEN
  INSERT INTO film (name) VALUES (table_name)
    RETURNING id INTO table_id;
END;

/
--------------------------------------------------------
--  Constraints for Table ACTOR
--------------------------------------------------------

  ALTER TABLE "SAKILA"."ACTOR" ADD CONSTRAINT "ACTOR_UK1" UNIQUE ("NAME")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "SAKILA"."ACTOR" ADD CONSTRAINT "ACTOR_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "SAKILA"."ACTOR" MODIFY ("NAME" NOT NULL ENABLE);
  ALTER TABLE "SAKILA"."ACTOR" MODIFY ("ID" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table FILM_ACTOR
--------------------------------------------------------

  ALTER TABLE "SAKILA"."FILM_ACTOR" ADD CONSTRAINT "FILM_ACTOR_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "SAKILA"."FILM_ACTOR" MODIFY ("ID" NOT NULL ENABLE);
  ALTER TABLE "SAKILA"."FILM_ACTOR" MODIFY ("ACTOR_ID" NOT NULL ENABLE);
  ALTER TABLE "SAKILA"."FILM_ACTOR" MODIFY ("FILM_ID" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table FILM
--------------------------------------------------------

  ALTER TABLE "SAKILA"."FILM" ADD CONSTRAINT "FILM_UK1" UNIQUE ("NAME")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "SAKILA"."FILM" ADD CONSTRAINT "FILM_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "SAKILA"."FILM" MODIFY ("NAME" NOT NULL ENABLE);
  ALTER TABLE "SAKILA"."FILM" MODIFY ("ID" NOT NULL ENABLE);
--------------------------------------------------------
--  Ref Constraints for Table FILM_ACTOR
--------------------------------------------------------

  ALTER TABLE "SAKILA"."FILM_ACTOR" ADD CONSTRAINT "FILM_ACTOR_FK1" FOREIGN KEY ("ACTOR_ID")
	  REFERENCES "SAKILA"."ACTOR" ("ID") ENABLE;
  ALTER TABLE "SAKILA"."FILM_ACTOR" ADD CONSTRAINT "FILM_ACTOR_FK2" FOREIGN KEY ("FILM_ID")
	  REFERENCES "SAKILA"."FILM" ("ID") ENABLE;
